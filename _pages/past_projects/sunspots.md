---
layout: general_content
permalink: /past_projects/sunspots/
---

<h2>Topological Data Analysis in Solar-Flare Prediction</h2>


<h3>Project Description</h3>


Eruptions generated by sunspots - large concentrations of magnetic
field on the visible surface of the sun - can have a number of dire
impacts on Earth-based technological systems, crippling satellites and
power grids, among many other things. With enough advance notice, the
effects of these events can be mitigated, but predicting them is a
real challenge.  The key to that prediction is the shapes of the
structures in the magnetic fields of these regions.  As you can see
from the sequence of magnetogram images below, the configuration of
the magnetic fields in this <i>active region</i> evolves during the
lead-up to a flare, starting out quite simple, as in (a), then growing
more and more complex as the onset of the flare approaches, and
relaxing to a slightly "fuzzier" state after the flare releases some
energy from the system (c).

<TABLE BORDER=0 CELLSPACING=8 CELLPADDING=8>
<TR ALIGN=Center>

<TD><A HREF="{{ '/assets/images/sunspot-evolution.jpeg' | relative_url }}" width="800"
onMouseMove="window.status='Show this image a little larger'; return
true"><IMG SRC="{{ '/assets/images/sunspot-evolution.jpeg' | relative_url }}" width="600"></A></TD>

</TR>
</TABLE>


In current operational practice, human experts use established
classification systems to categorize snapshots like these into one of
a number of classes, based on the shapes of the positive (white) and
negative (black) flux regions.  They then construct a forecast by
consulting lookup tables of flaring rates for each category that are
derived from historical records.


 Recently, there has been a burst of work on machine-learning (ML)
methods to automate this task, including the straightforward approach
of tossing images like the ones above, labeled as to whether or not a
flare occured in that active region within n hours, into a CNN.  Other
approaches have taken a feature-based approach, distilling
higher-order properties out of the magnetogram data and using those as
inputs to the ML methods.  To date, the features used in these
approaches have been predominately physics-based: the gradient of the
magnetic field, for instance, or the sum of its strength over
high-flux regions.


 The objective of this project is to leverage algorithms based on
the fundamental mathematics of shape - topology and geometry - to
improve the performance of these methods.  We use these powerful
techniques to extend the relevant feature set to include
characteristics of the magnetic field that are based purely on the
geometry and topology of 2D magnetogram images.  Using cubical
complexes, we compute the topology of different level sets of the
magnetogram images, caputing the results in the form of persistence
diagrams:


<TABLE BORDER=0 CELLSPACING=8 CELLPADDING=8>
<TR ALIGN=Center>

<TD><A HREF="{{ '/assets/images/sunspot-topology.jpeg' | relative_url }}" width="800"
onMouseMove="window.status='Show this image a little larger'; return
true"><IMG SRC="{{ '/assets/images/sunspot-topology.jpeg' | relative_url }}" width="600"></A></TD>

</TR>
</TABLE>

(Please see our <a href="{{ '/current_projects/topology/' | relative_url }}">main page on computational
topology</a> for definitions of the technical terms in that last
sentence.)


Even though this approach ignores the 3D structure of the full
electromagnetic fields, it can enhance the predictive skill of machine
learning systems.  Our results, described in the products listed
below, show clear topological changes emerging in magnetograms well
before flares occur, as well as clear improvements in the accuracy
scores of different machine-learning methods that employ featurized
persistence diagrams, alone and in combination with the traditional
physics-based features.  We have also shown that model complexity is
not necessarily an advantage in this context: indeed, simpler ML
methods often work just as well, if not better, than highly
sophisticated models.


This is the first time that systematic quantitative measures of
the shape of 2D magnetic structures in the photosphere have been
proposed for the purposes of flare prediction.  In a sense, this
amounts to a mathematical systemization of the venerable McIntosh and
Hale classification systems.  Note that this approach differs from
current studies in the solar-physics community that model the magnetic
field-line structure: it uses topology to address the structure of
two-dimensional sets.  The analysis is restricted to photospheric
magnetic field structures; the goal is to extract a formal
characterization of shape that can be leveraged by machine learning to
improve flare prediction.  Our considered addition of geometry into
these methods is essential if we are to capture the full richness and
physical relevance of the structures important in the evolution of a
sunspot.


<h3> People</h3>
<ul>
    <li>
    PhD student Varad Deshmukh
    </li> 
    <li>
    MS student Srinivas Baskar
    </li>
    <li>
    BS students Maxine Harnett (graduated 2020) and Theo Lincke
    </li>
    <li>
    <a href="{{ '/' | relative_url }}"> Liz Bradley</a>, Professor of Computer
    Science.
    </li>
    <li>
    <a href="http://amath.colorado.edu/faculty/jdm/Home.html"> Jim
    Meiss</a>, Professor of Applied Mathematics.
    </li>
    <li>
    <a href="https://www.colorado.edu/spaceweather/thomas-berger">
    Tom Berger</a>, director of
    the <a href="https://www.colorado.edu/spaceweather/">SWx-TREC</a>
    center.
    </li>
</ul>


<h3> Papers, talks, and other products</h3>
<ul>
    <li>
    V. Deshmukh, S. Baskar, T. Berger, E. Bradley, and J. D. Meiss,
    "Machine Learning Approaches to Solar-Flare Forecasting: Is Complex
    Better?," in review, <i>Astrophysical Journal</i>.  Preprint available
    on <a href="http://arxiv.org/abs/2202.08776">arxiv</a>.
    </li>
    <li>
    V. Deshmukh, T. Berger, E. Bradley, and
    J. D. Meiss, <a href="https://www.swsc-journal.org/articles/swsc/abs/2020/01/swsc190060/swsc190060.html">
    "Leveraging the Mathematics of Shape for Solar Magnetic Eruption
    Prediction,"</a> <i>Journal of Space Weather and Space
    Climate</i> <b>10</b>:13 (2020); doi.org/10.1051/swsc/2020014.
    Preprint available
    on <a href="https://arxiv.org/abs/2003.05827">arxiv</a>.
    </li>
    <li>
    V. Deshmukh, T. Berger, J. D. Meiss, and
    E. Bradley, <a href="https://ojs.aaai.org/index.php/AAAI/article/view/17795">
    "Shape-based Feature Engineering for Solar Flare Prediction,"</a> <i>
    IAAI (Proceedings of the 33rd Conference on Innovative Applications of
    Artificial Intelligence)</i>, February 2021.  Preprint available
    on <a href="http://arxiv.org/abs/2012.14405">arxiv</a>
    </li>
    <li>
    T. Berger, V. Deshmukh, E. Bradley, J. Meiss, and N. Nishizuka,
    <a href="https://ams.confex.com/ams/2020Annual/meetingapp.cgi/Paper/370903">
    "Leveraging Topological Data Analysis and Deep Learning for Solar
    Flare Prediction,"</a> Annual Meeting of the American Meteorological
    Society, Jan 2020.
    </li>
    <li> V. Deshmukh, T. Berger, E. Bradley, J. Meiss,
    <a href="https://ui.adsabs.harvard.edu/abs/2020AGUFMNG006..08D/abstract">"Systematic
    Evaluation of Computational Topology as an Effective Methodology for
    Improving Solar Eruption Prediction,"</a> Annual meeting of the
    American Geophysical Union (AGU), Dec 2020.
    </li>
    <li> T. Berger, V. Deshmukh, N. Flyer, B. Poduval, and E. Bradley,
    "Solar Flare Prediction with Minkowski CNNs," the Annual Meeting of
    the American Meteorological Society, January 2021.  You can find a
    video of the talk at
    the <a href="https://ams.confex.com/ams/101ANNUAL/meetingapp.cgi/Paper/382325">conference
    website</a>.
    </li>
    <li>
    A link to
    a <a href="https://github.com/SWxTREC/flares_code_tlincke125"> github
    repository containing code for segmenting magnetograms</a> (as
    documented in Theo's paper that I'll post here when it's submitted.)
    </li>
</ul>


<h3> Links</h3>
<ul>
    <li>
    A College of Engineering feature about
    the <a href="https://www.colorado.edu/engineering/2020/05/18/interdisciplinary-research-takes-new-approach-solar-flare-prediction">
    NSF grant</a> that is partially funding this project.
    </li>
    <li>
    A College
    of Engineering feature about the
    <a href="https://www.colorado.edu/engineering/2020/12/08/building-artificial-intelligence-study-sun">NASA
    grant</a> that is partially funding this project.
    </li>
</ul>


<h3> Support</h3>
<ul>
    <li> This material is based upon work supported by the National
    Science Foundation under grant number AGS #2001670 and NASA contract
    #80NSSC20K1404.  Any opinions, findings, and conclusions or
    recommendations expressed in this material are those of the author(s)
    and do not necessarily reflect the views of these funding agencies.
    </li>
</ul>


<IMG SRC="{{ '/assets/gifs/rainbow.gif' | relative_url }}" WIDTH="350" HEIGHT="5">   
